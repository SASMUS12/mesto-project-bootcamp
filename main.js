(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){"Escape"===e.key&&a(document.querySelector(".popup_opened"))}function r(e){var t=document.querySelector(".popup_opened");e.target.closest(".popup__container")||a(t)}e.d({},{Z0:()=>_,y4:()=>L,p4:()=>U,oc:()=>A,pF:()=>S,vi:()=>b,kH:()=>M,TN:()=>T,xS:()=>v,EV:()=>y});var n={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input_invalid",errorClass:"popup__input-error_active"};function o(e){document.addEventListener("keydown",t),e.addEventListener("mousedown",r),e.classList.add("popup_opened")}function a(e){document.removeEventListener("keydown",t),e.removeEventListener("mousedown",r),e.classList.remove("popup_opened")}var c={baseUrl:"https://mesto.nomoreparties.co/v1/wbf-cohort-2",headers:{authorization:"95b55e23-383f-429c-87bc-6d75636a35cd","Content-Type":"application/json"}};function i(e){return e.ok?e.json():Promise.reject(e.status)}function u(e){var t=function(e){var t=_.querySelector(".cards__item").cloneNode(!0),r=t.querySelector(".cards__delete"),n=t.querySelector(".cards__like"),a=e.likes,u=t.querySelector(".cards__like-counter"),s=t.querySelector(".cards__img");t.querySelector(".cards__text").textContent=e.name,s.alt=e.name,s.src=e.link,t.id=e._id;var l,d,f=t.id;return e.owner._id!==v&&r.remove(),a.length>0&&(u.textContent=a.length),function(e,t){return e.find((function(e){return e._id===t}))}(a,v)&&n.classList.add("cards__like_active"),n.addEventListener("click",(function(){n.classList.contains("cards__like_active")?function(e,t,r){return(n=t,fetch("".concat(c.baseUrl,"/cards/likes/").concat(n),{method:"DELETE",headers:c.headers}).then(i)).then((function(t){0===t.likes.length?r.textContent="":r.textContent=t.likes.length,e.classList.remove("cards__like_active")})).catch((function(e){console.error(e)}));var n}(n,f,u):function(e,t,r){return(n=t,fetch("".concat(c.baseUrl,"/cards/likes/").concat(n),{method:"PUT",headers:c.headers}).then(i)).then((function(t){r.textContent=t.likes.length,e.classList.add("cards__like_active")})).catch((function(e){console.error(e)}));var n}(n,f,u)})),function(e,t){t.addEventListener("click",(function(){var t;(t=e.id,fetch("".concat(c.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:c.headers}).then(i).catch((function(e){console.error(e)}))).then((function(){e.closest(".cards__item").remove()})).catch((function(e){console.error(e)}))}))}(t,r),l=e.name,d=e.link,s.addEventListener("click",(function(){S.textContent=l,b.alt=l,b.src=d,o(L)})),t}(e);y.prepend(t)}function s(e,t,r,n){var o=t.querySelector("#".concat(e.id,"-error"));o.textContent=r,e.classList.add(n.inputErrorClass),o.classList.add(n.errorClass)}function l(e,t,r){var n=t.querySelector("#".concat(e.id,"-error"));n.textContent="",e.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass)}function d(e,t,r){if(e.validity.valid)return e.onblur=function(){e.setAttribute("data-used","true")},void l(e,t,r);"true"!==e.dataset.used?e.onblur=function(){e.setAttribute("data-used","true"),s(e,t,e.validationMessage,r)}:s(e,t,e.validationMessage,r)}function f(e,t){e.reset(),Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(r){l(r,e,t),r.removeAttribute("data-used")}))}function m(e,t,r){!function(e,t){return Array.from(e.querySelectorAll(t.inputSelector)).some((function(r){return d(r,e,t),!r.validity.valid}))}(e,r)?(t.classList.remove(r.inactiveButtonClass),t.removeAttribute("disabled","")):(t.classList.add(r.inactiveButtonClass),t.setAttribute("disabled",""))}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v,h,y=document.querySelector(".cards"),_=document.querySelector(".template").content,b=document.querySelector(".popup__image"),S=document.querySelector(".popup__decription"),L=document.querySelector("#bigImage"),q=document.querySelector("#myModal"),C=document.querySelector("#myBtn"),E=document.forms.editProfile,k=document.querySelector("#profileTextTitle"),g=document.querySelector("#profileTextDescription"),A=document.querySelector("#newLocation"),x=document.querySelector("#newLocationBtn"),w=document.forms.addNewCard,T=document.querySelector("#cardTextTitle"),U=document.querySelector("#cardImptLink"),B=document.querySelector("#updateAvatar"),O=document.querySelector(".profile__avatar-edit"),P=document.forms.formUpdateAvatar,j=document.querySelector("#updateAvatarInput"),D=document.querySelector(".profile__name"),I=document.querySelector(".profile__about"),N=document.querySelector(".profile__avatar");function M(e,t){if(e)return t.textContent="Сохранение...",void t.setAttribute("disabled","");t.textContent="Сохранить",t.classList.add(n.disabledBtnClass),t.removeAttribute("disabled","")}document.querySelectorAll(".popup__close-button").forEach((function(e){e.addEventListener("click",(function(){a(e.closest(".popup"))}))})),C.addEventListener("click",(function(){f(E,n),o(q),k.value=D.textContent,g.value=I.textContent})),x.addEventListener("click",(function(){f(w,n),o(A)})),O.addEventListener("click",(function(){f(P,n),o(B)})),w.addEventListener("submit",(function(e){e.preventDefault();var t,r,n=e.submitter;M(!0,n),(t=T.value,r=U.value,fetch("".concat(c.baseUrl,"/cards"),{method:"POST",headers:c.headers,body:JSON.stringify({name:t,link:r})}).then(i)).then((function(t){u(t),e.target.reset(),a(A)})).catch((function(t){console.error(t),e.submitter.classList.add(validationData.disabledBtnClass)})).finally((function(){M(!1,n)}))})),E.addEventListener("submit",(function(e){e.preventDefault();var t,r,n=e.submitter;M(!0,n),(t=k.value,r=g.value,fetch("".concat(c.baseUrl,"/users/me"),{method:"PATCH",headers:c.headers,body:JSON.stringify({name:t,about:r})}).then(i)).then((function(t){D.textContent=t.name,I.textContent=t.about,e.target.reset(),a(q)})).catch((function(e){console.error(e)})).finally((function(){M(!1,n)}))})),P.addEventListener("submit",(function(e){e.preventDefault();var t,r=e.submitter;M(!0,r),(t=j.value,fetch("".concat(c.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:c.headers,body:JSON.stringify({avatar:t})}).then(i)).then((function(t){N.src=t.avatar,e.target.reset(),a(B)})).catch((function(e){console.error(e)})).finally((function(){M(!1,r)}))})),Promise.all([fetch("".concat(c.baseUrl,"/cards"),{headers:c.headers}).then(i),fetch("".concat(c.baseUrl,"/users/me"),{headers:c.headers}).then(i)]).then((function(e){var t,r,n,o=(n=2,function(e){if(Array.isArray(e))return e}(r=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],c=!0,i=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);c=!0);}catch(e){i=!0,o=e}finally{try{c||null==r.return||r.return()}finally{if(i)throw o}}return a}}(r,n)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],c=o[1];t=c,D.textContent=t.name,I.textContent=t.about,N.src=t.avatar,v=c._id,Array.from(a).reverse().forEach(u)})).catch((function(e){console.error(e)})),h=n,Array.from(document.querySelectorAll(h.formSelector)).forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault(),f(e,h)})),function(e,t){var r=e.querySelector(t.submitButtonSelector);m(e,r,t),e.addEventListener("input",(function(n){d(n.target,e,t),m(e,r,t)}))}(e,h)}))})();